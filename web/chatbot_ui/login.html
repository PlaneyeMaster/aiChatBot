<!doctype html>
<html lang="ko">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Login</title>
  <style>
    :root{
      --bg:#0c1116; --panel:#111924; --panel2:#0c141e;
      --border:#1f2a38; --border2:#243447; --text:#f1f5f9; --muted:#9aa6b2;
      --primary:#f97316; --primary-2:#0ea5e9;
      --radius:16px; --shadow:0 18px 46px rgba(2,8,23,0.4);
      --font-sans:"Apple SD Gothic Neo","Noto Sans KR","Malgun Gothic",sans-serif;
      --font-display:"Noto Serif KR","Nanum Myeongjo",serif;
    }
    *, *::before, *::after{box-sizing:border-box;}
    body{
      font-family:var(--font-sans);
      background:
        radial-gradient(900px 600px at 10% -10%, rgba(14,165,233,0.16), transparent 60%),
        radial-gradient(700px 600px at 90% 10%, rgba(249,115,22,0.18), transparent 55%),
        var(--bg);
      color:var(--text);
      margin:0;
      min-height:100vh;
      display:flex;
      align-items:center;
      justify-content:center;
      padding:24px 16px;
    }
    .wrap{
      width:100%;
      max-width:420px;
      padding:22px;
      border:1px solid var(--border);
      border-radius:var(--radius);
      background:linear-gradient(180deg, rgba(17,25,36,0.98), rgba(12,20,30,0.98));
      box-shadow:var(--shadow);
      animation:panelIn 0.6s ease both;
    }
    .brand{
      display:flex;
      align-items:center;
      gap:8px;
      font-size:12px;
      color:var(--muted);
      letter-spacing:0.2px;
      margin-bottom:14px;
    }
    label{display:block;margin:12px 0 6px;color:var(--muted);font-size:12px}
    input{
      width:100%;
      max-width:100%;
      padding:10px 12px;
      border-radius:12px;
      border:1px solid var(--border2);
      background:var(--panel2);
      color:var(--text);
      outline:none;
      transition:border 0.2s ease, box-shadow 0.2s ease;
    }
    input:focus{
      border-color:rgba(14,165,233,0.6);
      box-shadow:0 0 0 3px rgba(14,165,233,0.12);
    }
    button{
      width:100%;
      max-width:100%;
      margin-top:14px;
      padding:10px 12px;
      border-radius:12px;
      border:0;
      background:linear-gradient(135deg, var(--primary), #fb923c);
      color:white;
      font-weight:700;
      cursor:pointer;
      box-shadow:0 12px 24px rgba(249,115,22,0.25);
      transition:transform 0.15s ease, box-shadow 0.2s ease;
    }
    button:hover{ transform:translateY(-1px); box-shadow:0 16px 28px rgba(249,115,22,0.32); }
    .tiny{margin-top:10px;font-size:12px;color:var(--muted);line-height:1.6}
    a{color:#93c5fd;text-decoration:none}
    h1{margin:0 0 6px;font-size:18px;font-family:var(--font-display);letter-spacing:0.3px;}
    @keyframes panelIn{
      from{ opacity:0; transform:translateY(8px); }
      to{ opacity:1; transform:translateY(0); }
    }
  </style>
</head>
<body>
  <div class="wrap">
    <div class="brand">AI Chatbot · Access Portal</div>
    <h1>로그인</h1>

    <label>ID (영문만)</label>
    <input id="userId" placeholder="예: hanjun" inputmode="text" />

    <label>비밀번호 (숫자만)</label>
    <input id="password" placeholder="예: 1234" inputmode="numeric" />

    <button id="btnLogin">로그인</button>

    <div class="tiny" id="msg"></div>
    <div class="tiny">
      계정이 없나요? <a href="./signup.html">회원가입</a>
    </div>
  </div>

<script>
  const DEFAULT_API_BASE = "https://aichatbot-ez4g.onrender.com";
  const ID_RE = /^[A-Za-z]+$/;
  const PW_RE = /^[0-9]+$/;

  const $ = (id)=>document.getElementById(id);
  const msg = (t)=>{$("msg").textContent=t||""};
  const already = localStorage.getItem("user_id");
  if (already) location.href = "./index.html";

  $("btnLogin").addEventListener("click", async ()=>{
    const base = localStorage.getItem("api_base") || DEFAULT_API_BASE;
    const id = $("userId").value.trim();
    const password = $("password").value.trim();

    if (!ID_RE.test(id)) return msg("ID는 영문(A-Z, a-z)만 입력 가능합니다.");
    if (!PW_RE.test(password)) return msg("비밀번호는 숫자(0-9)만 입력 가능합니다.");

    msg("로그인 요청 중...");

    try{
      const res = await fetch(base + "/auth/login", {
        method:"POST",
        headers:{ "Content-Type":"application/json" },
        body: JSON.stringify({ id, password })
      });

      const json = await res.json().catch(()=> ({}));
      if (!res.ok){
        return msg(json.detail || ("로그인 실패: HTTP " + res.status));
      }
    }catch{
      return msg("로그인 실패: 네트워크 오류");
    }

    // MVP: user_id 저장(세션/토큰 없음)
    localStorage.setItem("user_id", id);
    localStorage.setItem("api_base", base);

    msg("로그인 성공. 채팅으로 이동합니다.");
    setTimeout(()=> location.href="./index.html", 500);
  });
</script>
</body>
</html>
