<!doctype html>
<html lang="ko">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <title>VAXPORT CHATBOT</title>
  <link rel="stylesheet" href="./index.css" />
</head>
<body>
<header>
  <div style="display:flex; align-items:center; gap:10px;">
    <h1>AI Chatbot MVP</h1>
    <span class="pill" id="pillStatus">idle</span>
  </div>
  <div style="display:flex; gap:10px; align-items:center; flex-wrap:wrap; justify-content:flex-end;">
    <button id="logoutBtn" class="secondary mini-btn">로그아웃</button>
  </div>
</header>

<div class="wrap">
  <!-- Left panel -->
  <div class="card" style="overflow:auto; max-height: calc(100vh - 32px - 56px);">
    <h2 style="margin:0 0 8px; font-size:14px;">Controls</h2>

    <div class="two">
      <div>
        <label>Character</label>
        <select id="character"></select>
      </div>
      <div>
        <label>Scenario</label>
        <select id="scenario"></select>
      </div>
    </div>
    <div class="charCard" style="margin-top:10px;">
      <img id="characterImage" class="charImg" alt="character" />
      <div class="charMeta">
        <div class="charName" id="characterName">-</div>
        <div id="characterDesc">-</div>
      </div>
    </div>
    <div class="scenarioCard" style="margin-top:10px;">
      <div class="scenarioLabel">Goal</div>
      <div class="scenarioValue" id="scenarioGoal">-</div>
      <div class="scenarioLabel" style="margin-top:8px;">Outline</div>
      <div class="scenarioValue" id="scenarioOutline">-</div>
    </div>

    <div class="row" style="margin-top:10px;">
      <button id="btnReloadCatalog" class="secondary">캐릭터/시나리오 새로고침</button>
      <button id="btnCreateSession">세션 생성</button>
    </div>

    <div class="hr"></div>

    <div class="hr"></div>

  </div>

  <!-- Right: chat -->
  <div class="card chatWrap">
    <div class="statusGrid">
      <div class="stat">
        <div class="k">Model</div>
        <div class="v mono" id="statModel">-</div>
      </div>
      <div class="stat">
        <div class="k">Memory</div>
        <div class="v mono" id="statMemory">saved:0 dup:0 low:0</div>
      </div>
      <div class="stat">
        <div class="k">Last error</div>
        <div class="v mono" id="statError">-</div>
      </div>
      <div class="stat">
        <div class="k">Session</div>
        <div class="v mono" id="statSession">-</div>
      </div>
    </div>

    <div class="chatBox" id="chatBox"></div>

    <div class="inputBar">
      <textarea id="inputText" placeholder="메시지를 입력하세요. (Shift+Enter 줄바꿈)"></textarea>
      <button id="btnSend">Send</button>
      <button id="btnStop" class="danger" disabled>Stop</button>
    </div>

    <div class="tiny">
      SSE: <code>POST /chat/stream</code> (text/event-stream). 서버가 meta 이벤트를 추가로 보내면 자동 표시됩니다.
    </div>
  </div>
</div>

<script src="./index.js"></script>
</body>
</html>
