<!doctype html>
<html lang="ko">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <title>Admin Console MVP</title>
  <link rel="stylesheet" href="./index.css" />
</head>
<body>
<header>
  <div style="display:flex; gap:10px; align-items:center;">
    <h1>Admin Console MVP</h1>
    <span class="pill" id="status">idle</span>
  </div>
  <span class="pill" id="apiPill">API: -</span>
</header>

<div class="wrap">
  <!-- Left: connection & navigation -->
  <div class="card">
    <h2 style="margin:0 0 10px; font-size:14px;">연결</h2>
    <label>API Base</label>
    <input id="apiBase" value="https://aichatbot-ez4g.onrender.com"/>

    <label>User ID</label>
    <input id="userId" value="user_001"/>

    <label>Admin API Key</label>
    <input id="adminKey" value="vaxportabcdefg" />

    <div style="margin-top:12px;" class="tabs">
      <div class="tab active" data-tab="users">Users</div>
      <div class="tab" data-tab="sessions">Sessions</div>
      <div class="tab" data-tab="memory">Memory</div>
    </div>

    <div style="margin-top:12px;">
      <button id="btnRefresh" class="secondary">현재 탭 새로고침</button>
    </div>

    <p class="muted" style="margin-top:12px; line-height:1.5;">
      Users: <code>GET/POST /admin/users</code><br/>
      Sessions: <code>GET /admin/sessions</code><br/>
      Messages: <code>GET /admin/sessions/{id}/messages</code><br/>
      Memory: <code>GET/DELETE /admin/memory</code>
    </p>
  </div>

  <!-- Right: content -->
  <div class="card" id="panel">
    <!-- Users -->
    <div id="tab-users">
      <h2 style="margin:0 0 10px; font-size:14px;">User Profile</h2>

      <div class="row">
        <button id="btnLoadUser" class="secondary">조회</button>
        <button id="btnSaveUser">저장(Upsert)</button>
      </div>

      <div class="two" style="margin-top:10px;">
        <div>
          <label>Tone</label>
          <input id="tone" placeholder="예: 정중하고 간결"/>
        </div>
        <div>
          <label>Expertise</label>
          <select id="expertise">
            <option value="">(미지정)</option>
            <option value="beginner">초급</option>
            <option value="intermediate">중급</option>
            <option value="advanced">고급</option>
          </select>
        </div>
        <div>
          <label>Goal</label>
          <input id="goal" placeholder="예: 업무 우선순위 정리"/>
        </div>
        <div>
          <label>Age Band</label>
          <select id="age_band">
            <option value="">(미지정)</option>
            <option value="10s">10대</option>
            <option value="20s">20대</option>
            <option value="30s">30대</option>
            <option value="40s">40대</option>
            <option value="50s">50대</option>
            <option value="60s+">60대+</option>
          </select>
        </div>
      </div>

      <p class="muted" style="margin-top:10px;">
        이 값들은 개인화 프롬프트 구성(톤/목표/전문성/연령)에 사용됩니다.
      </p>
    </div>

    <!-- Sessions -->
    <div id="tab-sessions" style="display:none;">
      <h2 style="margin:0 0 10px; font-size:14px;">Sessions</h2>
      <div class="two">
        <div>
          <div class="row">
            <button id="btnLoadSessions" class="secondary">세션 리스트 조회</button>
          </div>
          <div class="list" id="sessionList" style="margin-top:10px;"></div>
        </div>
        <div>
          <div class="row">
            <button id="btnLoadMessages" class="secondary" disabled>선택 세션 메시지 조회</button>
          </div>
          <div class="list mono" id="messageList" style="margin-top:10px;"></div>
        </div>
      </div>
    </div>

    <!-- Memory -->
    <div id="tab-memory" style="display:none;">
      <h2 style="margin:0 0 10px; font-size:14px;">Memory Items</h2>

      <div class="row">
        <button id="btnLoadMemory" class="secondary">메모리 조회</button>
      </div>

      <div style="overflow:auto; margin-top:10px;">
        <table>
          <thead>
            <tr>
              <th style="width:150px;">created_at</th>
              <th>text</th>
              <th style="width:160px;">pinecone_vector_id</th>
              <th style="width:90px;">action</th>
            </tr>
          </thead>
          <tbody id="memTbody"></tbody>
        </table>
      </div>

      <p class="muted" style="margin-top:10px;">
        삭제는 <b>Supabase row + Pinecone vector 동시 삭제</b>입니다.
      </p>
    </div>
  </div>
</div>

<script src="./index.js"></script>
</body>
</html>
